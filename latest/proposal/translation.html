<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Fedora Docs Toolchain Proposal Latest | Proposal | Translating AsciiDoc</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

    <link href="../../latest/_stylesheets/asciibinder.css" rel="stylesheet" />

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

   <!-- <link href="../../latest/_images/favicon32x32.png" rel="shortcut icon" type="text/css"> -->
  <!--[if IE]><link rel="shortcut icon" href="../../latest/_images/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body>
  <div class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="http://www.winglemeyer.org/"><img alt="winglemeyer.org" src="../../latest/_images/winglemeyer.org-logo.png"></a>
      </div>
    </div>
  </div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../index.html">even the horse knew</a>
      </li>
      <li class="hidden-xs active">
        <a href="../proposal/overview.html">Fedora Docs Toolchain Proposal Latest</a>
      </li>
      <li class="hidden-xs active">
        <a href="../proposal/overview.html">Proposal</a>
      </li>
      
      <li class="hidden-xs active">
        Translating AsciiDoc
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Proposal
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../proposal/overview.html">Overview</a></li>
            <li><a class="" href="../proposal/rationale.html">Why these Components?</a></li>
            <li><a class="" href="../proposal/converting.html">Converting DocBook</a></li>
            <li><a class="" href="../proposal/asciibinder.html">Converting a Repository</a></li>
            <li><a class=" active" href="../proposal/translation.html">Translating AsciiDoc</a></li>
            <li class="nav-header">
              <a class="" href="#" data-toggle="collapse" data-target="#topicSubGroup-0-5">
                <span id="sgSpan-0-5" class="fa fa-caret-right"></span>&nbsp;Proof of Concept (POC)
              </a>
              <ul id="topicSubGroup-0-5" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../proposal/poc/install.html">Pre-Requisites</a></li>

                  <li><a class="" href="../proposal/poc/single-repo.html">Build one Book or Documentation Collection</a></li>

                  <li><a class="" href="../proposal/poc/multi-repo.html">Build the Entire Site</a></li>
              </ul>
            </li>
            <li><a class="" href="../proposal/nextsteps.html">Next Steps</a></li>
            <li class="nav-header">
              <a class="" href="#" data-toggle="collapse" data-target="#topicSubGroup-0-7">
                <span id="sgSpan-0-7" class="fa fa-caret-right"></span>&nbsp;References
              </a>
              <ul id="topicSubGroup-0-7" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../proposal/references/pintail-notes.html">Pintail Notes</a></li>

                  <li><a class="" href="../proposal/references/downstream-notes.html">Downstream Integration Notes</a></li>
              </ul>
            </li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Translating AsciiDoc</h2>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Today, Fedora Documentation is translated by generating <code>.pot</code>
files from the DocBook source using <code>publican</code>.  These files are uploaded
to Zanata.  When the translation is complete, <code>.po</code> files are downloaded
and made available to publican to apply to the DocBook source.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-are-the-options"><a class="anchor" href="#what-are-the-options"></a>What are the options?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is no standard process for working with AsciiDoc and Zanata. Today,
Zanata doesn&#8217;t support AsciiDoc as an input format. The only real options
appear to be:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop publishing language translations until the Zanata team has a
solution.  + This is not really optimal, but if a solution is imminent
may not be devastating.</p>
</li>
<li>
<p>Perform language translations using transformations.</p>
<div class="paragraph">
<p>This would involve converting AsciiDoc to a format, such as DocBook,
that has a known <code>.pot/.po</code> toolchain. This could pose a real challenge
to publishing depending on the tooling as not all tools can support all
formats. I also feel like relying on multi-level automated conversions
is ultimately fragile. <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup></p>
</div>
</li>
<li>
<p>Find a tool to generate <code>.pot</code> files from AsciiDoc and to apply <code>.po</code> files to AsciiDoc.</p>
<div class="paragraph">
<p>So far, the best tool appears to be
<a href="https://po4a.alioth.debian.org/">po4a</a>.</p>
</div>
<div class="paragraph">
<p>po4a is packaged for Fedora. The project was started over 14 years
ago and has mostly stabilized.  It has mostly been in mainaintenance
mode for the last few years.  There is still an active, albeit small,
community and new patches are being accepted.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="translating-asciidoc-with-po4a-and-zanata"><a class="anchor" href="#translating-asciidoc-with-po4a-and-zanata"></a>Translating AsciiDoc with po4a and Zanata</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Translation is ultimately a five step process.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate <code>.pot</code> files.</p>
<div class="paragraph">
<p>po4a will generate files in the <code>podir</code> format.  The code snip below
will generate a full set of files.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>find . -name '*.adoc' | sed -e 's/.adoc$//' | \
xargs -I FILE po4a-gettextize -f asciidoc -m FILE.adoc -p ../pot/en-US/FILE.pot -M UTF-8</code></pre>
</div>
</div>
</li>
<li>
<p>Push the <code>.pot</code> files to Zanata</p>
<div class="paragraph">
<p>This delivers the files for translation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>zanata push --url $zanataurl --project-id $zanataproject --project-version $zanataversion \
--srcdir pot/$baselang --project-type podir</code></pre>
</div>
</div>
</li>
<li>
<p>Translate the content</p>
<div class="paragraph">
<p>Magical work done by amazing people who are not within the scope of
this document.</p>
</div>
</li>
<li>
<p>Pull the <code>.po</code> files from Zanata</p>
<div class="paragraph">
<p>Retrieve the translations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>zanata publican pull --url $zanataurl --project-id $zanataproject \
--project-version $zanataversion --lang $lang --transdir pot/ --project-type podir</code></pre>
</div>
</div>
</li>
<li>
<p>Apply the translations</p>
<div class="paragraph">
<p>This will replace all translated text with the translation, in place.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>po4a-translate -f asciidoc -m $file -l $file -p pot/$lang/$basename.po -M UTF-8</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. I feel very strongly that tools should do as little automated conversion as possible.  While most of the time nothing bad happens, when it does go sideways debugging is painful when multiple layers of conversions and intermediate platforms are involved.
</div>
</div>
      </div>
    </div>
  </div>
   <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
   <!-- Latest compiled and minified JavaScript -->
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
   <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>